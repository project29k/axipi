{% extends 'AxipiGoogleBundle::base.html.twig' %}

{% block title %}{{ page.title }}{% endblock %}

{% block main %}
    <!-- Google / Map -->
    <div class="row">
        <div class="col-lg-12">
            <div id="map" style="height:400px;">
            </div>
        </div>
    </div>
    <!-- Google / Map (end) -->
{% endblock %}

{% block style %}
    {{ parent() }}
{% endblock %}

{% block script %}
    {{ parent() }}
    <script type="text/javascript">
    var map;
    function initMap() {
        var myLatLng = {lat: {{ page.attribute('latitude') }}, lng: {{ page.attribute('longitude') }}};
        map = new google.maps.Map(document.getElementById('map'), {
            center: myLatLng,
            zoom: {{ page.attribute('zoom') }},
            overviewMapControl: false,
            overviewMapControlOptions: {
                opened: true
            },
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            panControl: true,
            mapTypeControl: true,
            mapTypeControlOptions: {
                style: google.maps.MapTypeControlStyle.DEFAULT
            },
            scrollwheel: true,
            streetViewControl: true,
            zoomControl: true,
            ZoomControlOptions: {
                position: google.maps.ControlPosition.TOP_LEFT,
                style: google.maps.ZoomControlStyle.SMALL
            }
        });

        var infowindow = new google.maps.InfoWindow({
            content: '{{ page.attribute('infowindow')|escape('js') }}'
        });

        var marker = new google.maps.Marker({
            position: myLatLng,
            map: map
        });

        marker.addListener('click', function() {
            infowindow.open(map, marker);
        });

        map.addListener('click', function() {
            infowindow.close();
        });
    }
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key={{ page.attribute('api_key') }}&amp;callback=initMap"></script>
{% endblock %}
